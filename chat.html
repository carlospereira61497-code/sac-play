<script>
// 1. Matriz de InteligÃªncia Consolidada (Baseada nos seus JSONs)
const fluxosOficiais = {
    "saudacao": () => {
        const hora = new Date().getHours();
        if (hora < 12) return "Bom dia";
        if (hora < 18) return "Boa tarde";
        return "Boa noite";
    },
    "respostas": {
        "treinamento": "OlÃ¡, tudo bem?\n\nâš ï¸ Nosso atendimento estÃ¡ em *treinamento*. Ã‰ um investimento em qualidade. Retornamos Ã s 18h. ðŸ’™",
        "tim": "ðŸ“¡ *NOC:* Consultando Backbone TIM. Verifique o LED 'Alarm'.",
        "vivo": "ðŸ“¡ *NOC:* Acessando gerÃªncia VIVO. Informe o ID do circuito.",
        "financeiro": "ðŸ’¸ *Faturamento:* Para 2Âª via de boletos, digite seu CPF/CNPJ.",
        "default": "ðŸ‘‹âœ¨ {{saudacao}}! Bem-vindo Ã  *Play MÃ³vel*! ðŸ“±ðŸ’™\n\nComo posso ajudar?\n1ï¸âƒ£ Suporte TÃ©cnico\n2ï¸âƒ£ Financeiro\n3ï¸âƒ£ Parcerias\n4ï¸âƒ£ Treinamento"
    }
};

// 2. LÃ³gica de Processamento
function processarResposta(mensagem) {
    const texto = mensagem.toLowerCase();
    if (texto.includes("treinamento")) return fluxosOficiais.respostas.treinamento;
    if (texto.includes("tim")) return fluxosOficiais.respostas.tim;
    if (texto.includes("vivo")) return fluxosOficiais.respostas.vivo;
    if (texto.includes("financeiro")) return fluxosOficiais.respostas.financeiro;
    
    return fluxosOficiais.respostas.default.replace("{{saudacao}}", fluxosOficiais.saudacao());
}

// 3. FunÃ§Ã£o de Envio (O CoraÃ§Ã£o do Chat)
function enviarMensagem() {
    const input = document.querySelector('input');
    const container = document.getElementById('chat-messages');
    
    if (!input || !container) return;

    const msg = input.value.trim();
    if (msg !== "") {
        // Mensagem do UsuÃ¡rio
        container.innerHTML += `<div class="message user">${msg}</div>`;
        input.value = '';

        // Resposta do Bot
        setTimeout(() => {
            const resposta = processarResposta(msg);
            container.innerHTML += `<div class="message bot">${resposta}</div>`;
            container.scrollTop = container.scrollHeight;
        }, 600);
    }
}

// 4. InicializaÃ§Ã£o do Sistema (Enter e BotÃ£o)
document.addEventListener('DOMContentLoaded', () => {
    const input = document.querySelector('input');
    const btn = document.querySelector('button');
    
    if (input) {
        input.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') enviarMensagem();
        });
    }
    if (btn) {
        btn.onclick = enviarMensagem;
    }
});
</script>